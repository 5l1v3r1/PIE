PIE 3.0 (Pre-Release) - Change Notes
Date: 1.30.2019

COMPLETED:
365-Trace
*Removed 5 minute runtime requirement.  Invoke-O365Trace.ps1 can be executed at any interval.  
** Submitted phishing messages are compared against completed submitted phishing messages.  New messages are processed accordingly.
** All pending messages are reviewed through single execution of Invoke-O365Trace.

*Updated ongoing log generation.  By sslawter, LogRhythm Community
** E-mail message trace now resumes where last-left off.
** Now supports retrieving up to 1,000,000 e-mail messages between executions, up from 1,000 messages.

*Added delay to ongoing log file rotation.  By sslwater, LogRhythm Community
** The added delay allows LogRhythm Sysmon collector to process the updated log file prior to file rotation.

*Added handler for special characters in e-mail subject line.  By Gewch, LogRhythm Community
** Enables PIE to parse special characters that are mapped to '?' on the Office 365 Message Trace Subject.

*Updated autoAuditMailboxes to support handling multiple matched entries.
** Enables auditing for users that have matching firstname/lastname records.

*Added support for .eml format e-mails.
** Parses message body, headers, links, and attachments from phishing reports submitted with the origin phishing message included in .eml format.

*Added support to filter out user@example.onmicrosoft.com from message counts.
** Configuration line 93 enables users to set if you want to include or exclude counts that contain *onmicrosoft.com.

*Updated gather and count evidence to 96 hours.
** Supports users reporting e-mails sent over a weekend period.

*Added e-mail message text body to case notes.
** Allows review of message contents from within Web Console.

*Added e-mail links to case notes.  
** Allows for easier review of all links contained within the e-mail.

*Added subjects to case notes
** Collects all subjects from sender from within evidence collection period (default 96 hours)

*Added URL whitelist.
** URLs added to the whitelist config file will be recorded as links but not be scanned by plugins.

Internal Organization E-mail Address Template Config:
* Add user configuration for last name collection.   
** Provide user with options and examples to set how their organization formats their e-mail addresses to best match capturing internal users surname.

365 Safe Links
* Parsing of Office 365 Safe Links is now automatic and does not require configuration.

## Plugins
Shodan:
* Updated plugin to version 1.7.  
** Plugin now enumerates all services identified on host by Shodan.
** Reports when Shodan does not have live data on a specific target.
** Add handler for IP addresses that have not ben scanned by Shodan.

Urlscan:
* New plugin.  Initiates URL scan for each URL and provides links to URLScan report and screenshot of the URL.
** If a link is direct to a file, the file's information is presented as captured by URLScan.
*  *File Name, SHA256 Hash, File Size, MIME Type, MIME Description
*  *Supports submitting file hashes through Wildfire plugin if Wildfire is enabled.
** Optional parameter to download screenshots locally to case folder with link added to LR case report.

Sucuri
* Updated to support Sucuri API v3. 
** Presents more in-depth information to the Case Report and LogRhythm Case.
** Fixed bug where results returned contained different number of header lines preventing JSON value import


VirusTotal
* Updated URL and File hash submission handlers.
* Combined calls to VirusTotal plugin to one section of code as an efficiency increase. 
* Presents more in-depth information to the Case Report and LogRhythm Case.
** Public API use with a submission rate limit of 4 submissions per minute
** Commercial API use with no rate limit


Bugfixes:
365-Trace
* Improved abnormal character handling within Subject line
* Various improvements to improve execution run times.

## Smart Response
365-Security and Compliance Controller
* Compliance Search
* Purge
* Search and Purge


